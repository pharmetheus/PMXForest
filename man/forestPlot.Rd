% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/forestPlot.R
\name{forestPlot}
\alias{forestPlot}
\title{Forest plots}
\usage{
forestPlot(dfres, plotData = NULL, plotRelative = TRUE, noVar = TRUE,
  referenceParameters = "func", sigdigits = 2,
  parameters = unique(dfres$PARAMETER), parameterLabels = parameters,
  groupNameLabels = NULL, referenceInfo = "auto",
  labelfun = label_parsed, ref_area = c(0.8, 1.2),
  ref_fill_col = "gray", ref_fill_alpha = 0.5, ref_line_size = 1,
  ref_line_type = "dotted", ref_line_col = "black",
  ci_line_type = "solid", ci_line_col = "blue", ci_line_size = 1,
  point_shape = 16, point_color = "blue", point_size = 3,
  tabTextSize = 10, strip.right.size = NULL, strip.top.size = NULL,
  ref_subj_label = "Reference subject",
  ref_area_label = "Reference area", point_label = "Point estimate",
  ci_label = "Confidence interval",
  statisticsLabel = paste("Statistics:", parameterLabels),
  xlb = "Parameter value", return = "plot", table = TRUE,
  rightStrip = TRUE, errbartabwidth = rep(c(2, 1), length(parameters)),
  errbarplotscale = 1.45, tabplotscale = 1.1, ...)
}
\arguments{
\item{dfres}{A data.frame as output from getForestDFSCM, getForestDFFREM or getForestDFemp.}

\item{plotData}{A \code{data.frame} to be used for creating the Forest plot. If \code{plotData} is provided \code{dfres} is ignored. See Details.}

\item{plotRelative}{Should the plot be made on the relative scale (TRUE or FALSE)}

\item{noVar}{Should the uncertainty in the reference be included (FALSE) or not (TRUE)}

\item{referenceParameters}{Character string indicating how the reference parameter estimates were obtained.
"true" means the final parameter estimates from the model. "func" means the mean parameter estimates across the posterior distribution.}

\item{sigdigits}{An integer number specifying the number of significant digits to use in the statistics tables.}

\item{parameters}{A character vector with the parameters present in the dfres$PARAMETER column to be included in the output.}

\item{parameterLabels}{A character vector with the names of the parameters as they will appear in the Forest plot. Can be \code{plotmath} expressions. Is by default the same as dfres$PARAMETER.}

\item{groupNameLabels}{A character vector with the names of the covariate groups as they will appear in the Forest plot. Is by default the same as dfres$GROUPNAME.}

\item{referenceInfo}{A character string or NULL. If set to NULL, no information about how the reference line was derived will be displayed. If set to "auto",
generic information based on \code{referenceParameters} and the \code{REFROW} column in \code{dfres} will be included at the bottom of the plot. If not NULL or "auto",
then the character string will be displayed below the plot. Uses \code{ggpubr::annotate_figure} and \code{ggpubr::text_grob} to place and format the text.
Formatting instructions to \code{ggpubr::text_grob} are passed on through \code{...}. Default is "auto".}

\item{labelfun}{A label function compatible with \code{labeller}. Used to format \code{parameterLabels} used as column facet labels for the errorbar and table plots.
Default is \code{label_parsed}.}

\item{ref_area}{Numerical vector indicating the horizontal size of the reference area. The default is \code{c(0.8,1.25)}. Used to multiply the reference value to derive the actual
xmin and xmax values for the reference area.}

\item{ref_fill_col}{Reference area color.}

\item{ref_fill_alpha}{Reference area alpha value.}

\item{ref_line_size}{Reference line size.}

\item{ref_line_type}{Reference line linetype.}

\item{ref_line_col}{Reference line color.}

\item{ci_line_type}{Errorbar linetype.}

\item{ci_line_col}{Errorbar color.}

\item{ci_line_size}{Errorbar size.}

\item{point_shape}{Point estimate shape.}

\item{point_color}{Point estimate color.}

\item{point_size}{Size of the point estimate symbol.}

\item{tabTextSize}{The size (pt) of the text in the table plots.}

\item{strip.right.size}{Size of the facet text on the right (in pt). Default is NULL, which will fall back on the theme default.}

\item{strip.top.size}{Size of the facet text on the top (in pt). Default is NULL, which will fall back on the theme default.}

\item{ref_subj_label}{A character string indicating the label to be used for the reference subject in the figure legend. Default is "Reference subject".}

\item{ref_area_label}{A character string indicating the label to be used for the reference area in the figure legend. Default is "Reference area".}

\item{point_label}{A character string indicating the label to be used for the point estimates in the figure legend. Default is "Point estimate".}

\item{ci_label}{A character string indicating the label to be used for the confidence interval in the figure legend. Default is "Confidence interval".}

\item{statisticsLabel}{A vector of character string of the same length as \code{parameters} to be used as facet labels for the table plots.}

\item{xlb}{x-axis label for the errorbar plots}

\item{return}{Either "plot" (default), "plotList" or "data". "plot" returns the \code{ggpubr::ggarrange} object. "plotList" returns a list of the different plots that make up
the Forest plot (see Details). "data" returns a \code{data.frame} with the actual data used to create the Forest plot.}

\item{table}{Logical. Should the table plots be included in the Forest plot or not.}

\item{rightStrip}{Should the facet title in the rightmost panel in the Forest plot be displayed? If TRUE (the default) \code{groupNameLabels} will be used as the facets labels.}

\item{errbartabwidth}{A numerical vector of length 2 times the number of parameters included in the Forest plot, specifying the relative width of the errorbar and table plots. Have no effect when \code{table} is FALSE.}

\item{errbarplotscale}{Scaling factor for the width of the leftmost errorbar plot to compensate for y-axis labels.}

\item{tabplotscale}{Scaling factor for the width of the rightmost column (usually a table plot) to adjust for the size of the right strip.}

\item{...}{Arguments passed on to \code{ggpubr::text_grob}.}
}
\value{
A \code{ggpubr::ggarrange} object, a list of plots or a \code{data.frame}.
}
\description{
Create Forest plots consisting of alternating columns of errorbar plots and tabulated numerical statistics.
}
\details{
If \code{plotData} is NULL, \code{dfres} is passed to \code{setupForestPlotData} to create a \code{data.frame} that contains the exact data to be plotted, including the numerical statistics.
If \code{return} is set to "data" then the \code{data.frame} is returned. This makes it possible to to review the data and/or do modifications if necessary. \code{forestPlot} can
be called with \code{plotData} set to the name of the \code{data.frame}, in which case \code{dfres} is not required and the \code{plotData} \code{data.frame} will be used for
creating the Forest plot.

The graphical settings use standard \code{ggplot} syntax.
}
\examples{
\dontrun{
forestPlot(dfres,plotRelative = FALSE)
}
}
